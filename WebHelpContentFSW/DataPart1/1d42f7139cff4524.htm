
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:tocPath="Network and Remote Operation|Remote Control Basics|Command Sequence and Synchronization" MadCap:InPreviewMode="false" MadCap:RuntimeFileType="Topic" MadCap:TargetType="WebHelp" MadCap:PathToHelpSystem="../" MadCap:HelpSystemFileName="FSW_HTML_UserManuals_en.xml" MadCap:SearchType="Stem">
<!-- saved from url=(0014)about:internet -->
<head><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE9">
</meta>
        <link href="Resources/workspace/css/madcap_mod.css" rel="stylesheet" type="text/css">
</link><title>Preventing Overlapping Execution</title>
        <style>
					@import url(Resources/workspace/css/html_help.css);
				</style>
        <link disabled="disabled" href="Resources/workspace/css/html_help.css" rel="stylesheet" type="text/css">
</link>
        <MadCap:concept term="ID_90bf96bac30a9a170a00206a010d8a7e-ebf757a0c30a9a170a00206a01ff747b-en-US;ID_4512ce2c671d746b0a710a31015c314a-ebf757a0c30a9a170a00206a01ff747b-en-US;ID_5646bfba67264a290a00206a00791b06-ebf757a0c30a9a170a00206a01ff747b-en-US;ID_e7fe852f67264a290a00206a00dd64b4-ebf757a0c30a9a170a00206a01ff747b-en-US;ID_0eddb1af67264a290a00206a0121a42e-ebf757a0c30a9a170a00206a01ff747b-en-US;ID_3b7a582667264a290a00206a0026247b-ebf757a0c30a9a170a00206a01ff747b-en-US;ID_6462059d67264a290a00206a01f50981-ebf757a0c30a9a170a00206a01ff747b-en-US;ID_b65bfcf167264a290a00206a00ab3c58-ebf757a0c30a9a170a00206a01ff747b-en-US;ID_aa5f72ac67264a290a00206a0006c108-ebf757a0c30a9a170a00206a01ff747b-en-US;ID_df7a199267264a290a00206a01ba3b46-ebf757a0c30a9a170a00206a01ff747b-en-US;ID_4836579567264a290a00206a000352cb-ebf757a0c30a9a170a00206a01ff747b-en-US;ID_63cb668367264a290a00206a01d31106-ebf757a0c30a9a170a00206a01ff747b-en-US;ID_4291687867264a290a00206a0002c4ba-ebf757a0c30a9a170a00206a01ff747b-en-US;ID_94af5db467264a290a00206a0165f4e7-ebf757a0c30a9a170a00206a01ff747b-en-US;ID_0c29cb6667264a290a00206a01b32efe-ebf757a0c30a9a170a00206a01ff747b-en-US;">
</MadCap:concept>
        <script src="Resources/workspace/jscript/nsr.js">/* <![CDATA[ */
        /* ]]> */</script>
        <script src="SkinSupport/MadCapAll.js" type="text/javascript">/* <![CDATA[ */
        /* ]]> */</script>
    <script src="Resources/workspace/jscript/shortcut.js" type="text/javascript">/* <![CDATA[ */
/* ]]> */</script><script src="Resources/workspace/jscript/dy-shortcut.js" type="text/javascript">/* <![CDATA[ */
/* ]]> */</script></head><body><div id="nsr"><span><a class="chm-breadcrumb" href="f877943803274912.htm">Network and Remote Operation</a> &gt; <a class="chm-breadcrumb" href="3483d15d86f943cb.htm">Remote Control Basics</a> &gt; <a class="chm-breadcrumb" href="8368edb68e8b4ff7.htm">Command Sequence and Synchronization</a> &gt; <span class="chm-breadcrumb">Preventing Overlapping Execution</span></span></div><div id="mainbody"><div style="width: 95%"><a name="top">
</a><div class="chm-chaptertitle">Preventing Overlapping Execution</div><p>To prevent an overlapping execution of commands, one of the commands <span class="command">*OPC</span>, <span class="command">*OPC?</span> or <span class="command">*WAI</span> can be used. All three commands cause a certain action only to be carried out after the hardware has been set. The controller can be forced to wait for the corresponding action to occur.</p><a name="kanchor2750">
</a><a name="kanchor2751">
</a><a name="kanchor2752">
</a><a name="kanchor2753">
</a><div class="block"><a name="ID_4512ce2c671d746b0a710a31015c314a-ebf757a0c30a9a170a00206a01ff747b-en-US">
</a><span class="table-caption">Synchronization using *OPC, *OPC? and *WAI</span><table border="1"><colgroup><col>
</col><col>
</col><col>
</col></colgroup><thead><tr class="oddrow"><th valign="top"><p>Command</p></th><th valign="top"><p>Action</p></th><th valign="top"><p>Programming the controller</p></th></tr></thead><tbody><tr class="oddrow"><td valign="top"><p>*OPC</p></td><td valign="top"><p>Sets the Operation Complete bit in the ESR after all previous commands have been executed.</p></td><td valign="top"><div class="block"><ul class="list"><li style="margin-bottom:0; padding-bottom:0;" value="1">Setting bit 0 in the ESE</li><li style="margin-bottom:0; padding-bottom:0;" value="2">Setting bit 5 in the SRE</li><li style="margin-bottom:0; padding-bottom:0;" value="3">Waiting for service request (SRQ)</li></ul></div></td></tr><tr class="evenrow"><td valign="top"><p>*OPC?</p></td><td valign="top"><p>Stops command processing until 1 is returned. This occurs when all pending operations are completed.</p></td><td valign="top"><p>Send *OPC? directly after the command whose processing must be terminated before other commands can be executed.</p></td></tr><tr class="oddrow"><td valign="top"><p>*WAI</p></td><td valign="top"><p>Stops further command processing until all commands sent before *WAI have been executed.</p></td><td valign="top"><p>Send *WAI directly after the command whose processing must be terminated before other commands are executed.</p></td></tr></tbody></table></div><p>Command synchronization using <span class="command">*WAI</span> or <span class="command">*OPC?</span> is a good choice if the overlapped command takes only little time to process. The two synchronization commands simply block overlapped execution of the command. Append the synchronization command to the overlapping command, for example:</p><p><span class="command">SINGle; *OPC?</span></p><p>For time consuming overlapped commands, you can allow the controller or the instrument to do other useful work while waiting for command execution. Use one of the following methods:</p><div class="block"><a name="ID_5646bfba67264a290a00206a00791b06-ebf757a0c30a9a170a00206a01ff747b-en-US">
</a><div class="procedure_title">*OPC with a service request</div><div><ol class="procedure"><li id="ID_e7fe852f67264a290a00206a00dd64b4-ebf757a0c30a9a170a00206a01ff747b-en-US" value="1"><p>Set the OPC mask bit (bit no. 0) in the ESE: *ESE 1</p></li><li id="ID_0eddb1af67264a290a00206a0121a42e-ebf757a0c30a9a170a00206a01ff747b-en-US" value="2"><p>Set bit no. 5 in the SRE: <span class="command">*SRE 32</span> to enable ESB service request.</p></li><li id="ID_3b7a582667264a290a00206a0026247b-ebf757a0c30a9a170a00206a01ff747b-en-US" value="3"><p>Send the overlapped command with <span class="command">*OPC</span>.</p></li><li id="ID_6462059d67264a290a00206a01f50981-ebf757a0c30a9a170a00206a01ff747b-en-US" value="4"><p>Wait for a service request.</p><p>The service request indicates that the overlapped command has finished.</p></li></ol></div></div><div class="block"><a name="ID_b65bfcf167264a290a00206a00ab3c58-ebf757a0c30a9a170a00206a01ff747b-en-US">
</a><div class="procedure_title">*OPC? with a service request</div><div><ol class="procedure"><li id="ID_aa5f72ac67264a290a00206a0006c108-ebf757a0c30a9a170a00206a01ff747b-en-US" value="1"><p>Set bit no. 4 in the SRE: <span class="command">*SRE 16</span> to enable MAV service request.</p></li><li id="ID_df7a199267264a290a00206a01ba3b46-ebf757a0c30a9a170a00206a01ff747b-en-US" value="2"><p>Send the overlapped command with <span class="command">*OPC?</span>.</p></li><li id="ID_4836579567264a290a00206a000352cb-ebf757a0c30a9a170a00206a01ff747b-en-US" value="3"><p>Wait for a service request.</p><p>The service request indicates that the overlapped command has finished.</p></li></ol></div></div><div class="block"><a name="ID_63cb668367264a290a00206a01d31106-ebf757a0c30a9a170a00206a01ff747b-en-US">
</a><div class="procedure_title">Event status register (ESE)</div><div><ol class="procedure"><li id="ID_4291687867264a290a00206a0002c4ba-ebf757a0c30a9a170a00206a01ff747b-en-US" value="1"><p>Set the OPC mask bit (bit no. 0) in the ESE: <span class="command">*ESE 1</span></p></li><li id="ID_94af5db467264a290a00206a0165f4e7-ebf757a0c30a9a170a00206a01ff747b-en-US" value="2"><p>Send the overlapped command without <span class="command">*OPC</span>, <span class="command">*OPC?</span> or <span class="command">*WAI</span>.</p></li><li id="ID_0c29cb6667264a290a00206a01b32efe-ebf757a0c30a9a170a00206a01ff747b-en-US" value="3"><p>Poll the operation complete state periodically (with a timer) using the sequence: <span class="command">*OPC; *ESR?</span></p><p>A return value (LSB) of 1 indicates that the overlapped command has finished.</p></li></ol></div></div><div class="chm-go-to-top"><span><a class="chm-go-to-top" href="#top">Top</a></span></div></div></div><script type="text/javascript" src="SkinSupport/MadCapBodyEnd.js">/* <![CDATA[ */
/* ]]> */</script></body></html>