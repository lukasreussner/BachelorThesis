
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:tocPath="Network and Remote Operation|Automating Tasks with Remote Command Scripts" MadCap:InPreviewMode="false" MadCap:RuntimeFileType="Topic" MadCap:TargetType="WebHelp" MadCap:PathToHelpSystem="../" MadCap:HelpSystemFileName="FSW_HTML_UserManuals_en.xml" MadCap:SearchType="Stem">
<!-- saved from url=(0014)about:internet -->
<head><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE9">
</meta>
        <link href="Resources/workspace/css/madcap_mod.css" rel="stylesheet" type="text/css">
</link><title>How to Create and Export SCPI Scripts</title>
        <style>
					@import url(Resources/workspace/css/html_help.css);
				</style>
        <link disabled="disabled" href="Resources/workspace/css/html_help.css" rel="stylesheet" type="text/css">
</link>
        <MadCap:concept term="ID_e8c25e69ef420a240a002019016ebf4c-9b8758e6d84481250a001ae76d72c586-en-US;ID_84e95981ec6611e19fc7c99df325d30c-9b8758e6d84481250a001ae76d72c586-en-US;ID_4ab615ded5a011e780dd82612892ba9e-9b8758e6d84481250a001ae76d72c586-en-US;ID_4ab68a11d5a011e780dd82612892ba9e-9b8758e6d84481250a001ae76d72c586-en-US;ID_4ab74d67d5a011e780dd82612892ba9e-9b8758e6d84481250a001ae76d72c586-en-US;ID_fe9617d6d9be7fea0a001ae7016eaa1d-9b8758e6d84481250a001ae76d72c586-en-US;ID_6730bc3dd9be7fea0a001ae7044fe181-9b8758e6d84481250a001ae76d72c586-en-US;ID_6ec1cf8806e53d120a001ae753a059a3-9b8758e6d84481250a001ae76d72c586-en-US;ID_449b037bec6f11e19fc7c99df325d30c-9b8758e6d84481250a001ae76d72c586-en-US;ID_a200cd6ed9be7fea0a001ae71fdc56b6-9b8758e6d84481250a001ae76d72c586-en-US;ID_7cda054fd9be7fea0a001ae74a67bb39-9b8758e6d84481250a001ae76d72c586-en-US;ID_754b11c6ec7811e19fc7c99df325d30c-9b8758e6d84481250a001ae76d72c586-en-US;ID_84e95982ec6611e19fc7c99df325d30c-9b8758e6d84481250a001ae76d72c586-en-US;ID_f8485b38d4da11e79818cc2fcba197e4-9b8758e6d84481250a001ae76d72c586-en-US;ID_040f5885d9be7fea0a001ae7576d665d-9b8758e6d84481250a001ae76d72c586-en-US;ID_4d582dc9d9be7fea0a001ae7046c6f82-9b8758e6d84481250a001ae76d72c586-en-US;ID_4f29444dd9be7fea0a001ae721afc699-9b8758e6d84481250a001ae76d72c586-en-US;ID_ce04bc66d9be7fea0a001ae77b75afc8-9b8758e6d84481250a001ae76d72c586-en-US;ID_5d5261fdce8d11e7ac46b8304a2834da-9b8758e6d84481250a001ae76d72c586-en-US;ID_1bb7aedbd9be7fea0a001ae7650b22dc-9b8758e6d84481250a001ae76d72c586-en-US;ID_b48cc9a6d9be7fea0a001ae716942a9d-9b8758e6d84481250a001ae76d72c586-en-US;ID_13f787d3d9be7fea0a001ae74559ff3d-9b8758e6d84481250a001ae76d72c586-en-US;ID_10d93b05dd9a1efe0a001ae7055f8f88-9b8758e6d84481250a001ae76d72c586-en-US;ID_73ffc94cf5c911e18aeecd2a1a70d1cc-9b8758e6d84481250a001ae76d72c586-en-US;ID_72aff657d9be7fea0a001ae70846c03f-9b8758e6d84481250a001ae76d72c586-en-US;ID_7fb7e8f3d9be7fea0a001ae777e9f36f-9b8758e6d84481250a001ae76d72c586-en-US;ID_b23a9693d9be7fea0a001ae75aee4de5-9b8758e6d84481250a001ae76d72c586-en-US;ID_9a1d3436d9be7fea0a001ae71161309b-9b8758e6d84481250a001ae76d72c586-en-US;ID_6b5fe6efd9be7fea0a001ae7355d1c7c-9b8758e6d84481250a001ae76d72c586-en-US;ID_f0985176d9be7fea0a001ae76bc8dc89-9b8758e6d84481250a001ae76d72c586-en-US;">
</MadCap:concept>
        <script src="Resources/workspace/jscript/nsr.js">/* <![CDATA[ */
        /* ]]> */</script>
        <script src="SkinSupport/MadCapAll.js" type="text/javascript">/* <![CDATA[ */
        /* ]]> */</script>
    <script src="Resources/workspace/jscript/shortcut.js" type="text/javascript">/* <![CDATA[ */
/* ]]> */</script><script src="Resources/workspace/jscript/dy-shortcut.js" type="text/javascript">/* <![CDATA[ */
/* ]]> */</script></head><body><div id="nsr"><span><a class="chm-breadcrumb" href="f877943803274912.htm">Network and Remote Operation</a> &gt; <a class="chm-breadcrumb" href="34ce008b52034f5a.htm">Automating Tasks with Remote Command Scripts</a> &gt; <span class="chm-breadcrumb">How to Create and Export SCPI Scripts</span></span></div><div id="mainbody"><div style="width: 95%"><a name="top">
</a><div class="chm-chaptertitle">How to Create and Export SCPI Scripts</div><p>Using the SCPI Recorder functions, you can create a SCPI script directly on the instrument and then export the script for use on the controller. The SCPI Recorder allows you to record SCPI command lists either automatically or manually.</p><div class="block"><a name="ID_84e95981ec6611e19fc7c99df325d30c-9b8758e6d84481250a001ae76d72c586-en-US">
</a><div class="procedure_title">How to record SCPI commands automatically</div><p>The following procedure explains how to record SCPI commands automatically during operation.</p><div><ol class="procedure"><li id="ID_4ab615ded5a011e780dd82612892ba9e-9b8758e6d84481250a001ae76d72c586-en-US" value="1"><p>Define the setting or navigate to the function you want to record.</p><p>To query trace or marker results, select the result diagram.</p></li><li id="ID_4ab68a11d5a011e780dd82612892ba9e-9b8758e6d84481250a001ae76d72c586-en-US" value="2"><p>On the screen, tap and hold, or right-click the measurement setting, function, or result display.</p><p>The context-sensitive menu containing the SCPI command for that particular setting, function, or result is displayed.</p><p><b>Tip:</b> If the SCPI command menu is not displayed, you probably tapped outside of a softkey or input field, for example in a block diagram. Tap within the corresponding softkey, button or input field, or in a result display, to display the context-sensitive SCPI command menu.<br/></p></li><li id="ID_4ab74d67d5a011e780dd82612892ba9e-9b8758e6d84481250a001ae76d72c586-en-US" value="3"><p>Select "Show SCPI result query commands" or "Show SCPI command", depending on which item you selected.</p></li><li id="ID_fe9617d6d9be7fea0a001ae7016eaa1d-9b8758e6d84481250a001ae76d72c586-en-US" value="4"><p>On the toolbar, select the SCPI Recorder icon.</p><div class="margin-in-step"><img border="0" src="Resources/Images/img5748036ed89608310a001ae7115be840_1_--_--_PNG96.png" alt="" title="" class="margin-in-step">
</img></div><p>The SCPI Recorder dialog box is displayed.</p></li><li id="ID_6730bc3dd9be7fea0a001ae7044fe181-9b8758e6d84481250a001ae76d72c586-en-US" value="5"><p>Select "Auto Recording": "On".</p><p>From now on, the commands required to execute all steps you perform on the instrument are recorded.</p></li><li id="ID_6ec1cf8806e53d120a001ae753a059a3-9b8758e6d84481250a001ae76d72c586-en-US" value="6"><p>To query results in the SCPI script:</p><ol type="a" class="proc2"><li value="1"><p>Right-click (or tap and hold) in the result display.</p><p>All possible commands to query the results in the diagram are displayed in the SCPI command menu.</p></li><li value="2"><p>Select the results you want to query.</p></li><li value="3"><p>Select "Add SCPI Command to Recording".</p></li></ol></li><li id="ID_449b037bec6f11e19fc7c99df325d30c-9b8758e6d84481250a001ae76d72c586-en-US" value="7"><p>To stop SCPI recording, select the SCPI Recorder icon again.</p><p>The SCPI Recorder dialog box with the recorded command list is displayed.</p></li><li id="ID_a200cd6ed9be7fea0a001ae71fdc56b6-9b8758e6d84481250a001ae76d72c586-en-US" value="8"><p>Select "Auto Recording": "Off".</p></li><li id="ID_7cda054fd9be7fea0a001ae74a67bb39-9b8758e6d84481250a001ae76d72c586-en-US" value="9"><p>Save the recorded command list to a file for later use.</p><ol type="a" class="proc2"><li value="1"><p>Select "Save As".</p></li><li value="2"><p>Define a file name for the script file.</p></li></ol></li></ol></div></div><div class="block"><a name="ID_754b11c6ec7811e19fc7c99df325d30c-9b8758e6d84481250a001ae76d72c586-en-US">
</a><div class="procedure_title">How to record SCPI commands manually</div><div><ol class="procedure"><li id="ID_84e95982ec6611e19fc7c99df325d30c-9b8758e6d84481250a001ae76d72c586-en-US" value="1"><p>Determine the required SCPI command as described in <a class="xref" href="263b7738fa63466d.htm#ID_772bce76d5a111e780dd82612892ba9e-9b8758e6d84481250a001ae76d72c586-en-US">"How to Determine the Required SCPI Command"</a>.</p></li><li id="ID_f8485b38d4da11e79818cc2fcba197e4-9b8758e6d84481250a001ae76d72c586-en-US" value="2"><p>From the SCPI command dialog box, select "Add SCPI Command to Recording".</p><p>The command is added to the SCPI Recorder command list.</p></li><li id="ID_040f5885d9be7fea0a001ae7576d665d-9b8758e6d84481250a001ae76d72c586-en-US" value="3"><p>Repeat these steps for any settings, functions, or results you want to record.</p></li><li id="ID_4d582dc9d9be7fea0a001ae7046c6f82-9b8758e6d84481250a001ae76d72c586-en-US" value="4"><p>To check the progress of the recording, select the SCPI Recorder icon in the toolbar.</p><div class="margin-in-step"><img border="0" src="Resources/Images/img5748036ed89608310a001ae7115be840_1_--_--_PNG96.png" alt="" title="" class="margin-in-step">
</img></div><p>The SCPI Recorder dialog box with the currently recorded command list is displayed.</p></li><li id="ID_4f29444dd9be7fea0a001ae721afc699-9b8758e6d84481250a001ae76d72c586-en-US" value="5"><p>Save the recorded command list to a file for later use.</p><ol type="a" class="proc2"><li value="1"><p>Select "Save As".</p></li><li value="2"><p>Define a file name for the script file.</p></li></ol></li></ol></div></div><div class="block"><a name="ID_ce04bc66d9be7fea0a001ae77b75afc8-9b8758e6d84481250a001ae76d72c586-en-US">
</a><div class="procedure_title">To edit a SCPI command list</div><p>All command lists can be edited after recording, either directly on the instrument or in any suitable editor on the controller. The following functions describe how to edit the SCPI command list directly in the SCPI Recorder dialog box.</p><div><ol class="procedure"><li id="ID_5d5261fdce8d11e7ac46b8304a2834da-9b8758e6d84481250a001ae76d72c586-en-US" value="1"><p>On the toolbar, select the SCPI Recorder icon.</p><div class="margin-in-step"><img border="0" src="Resources/Images/img5748036ed89608310a001ae7115be840_1_--_--_PNG96.png" alt="" title="" class="margin-in-step">
</img></div><p>The SCPI Recorder dialog box with the currently recorded command list is displayed.</p></li><li id="ID_1bb7aedbd9be7fea0a001ae7650b22dc-9b8758e6d84481250a001ae76d72c586-en-US" value="2"><p>To remove the most recently recorded command, select "Remove Last" in the SCPI Recorder dialog box.</p></li><li id="ID_b48cc9a6d9be7fea0a001ae716942a9d-9b8758e6d84481250a001ae76d72c586-en-US" value="3"><p>To remove any other command in the recorded command list:</p><ol type="a" class="proc2"><li value="1"><p>Select the command.</p></li><li value="2"><p>Press the BACK SPACE key on the front panel of the instrument, or press the DELETE key on a connected keyboard.</p></li></ol></li><li id="ID_13f787d3d9be7fea0a001ae74559ff3d-9b8758e6d84481250a001ae76d72c586-en-US" value="4"><p>To insert a command within the recorded command list:</p><ol type="a" class="proc2"><li value="1"><p>Define the setting or navigate to the function you want to record.</p></li><li value="2"><p>Select "Copy SCPI Command to ClipBoard".</p></li><li value="3"><p>Tap and hold or right-click the position in the SCPI command list at which you want to insert the new command.</p></li><li value="4"><p>From the context menu, select "Paste".</p></li></ol></li><li id="ID_10d93b05dd9a1efe0a001ae7055f8f88-9b8758e6d84481250a001ae76d72c586-en-US" value="5"><p>Select "Save As" to store the changes to the script.</p></li></ol></div></div><div class="block"><div class="subtitle"><a name="ID_73ffc94cf5c911e18aeecd2a1a70d1cc-9b8758e6d84481250a001ae76d72c586-en-US">
</a>How to check a SCPI script</div></div><p>The easiest way to check a script is to execute it, for example in the auxiliary tool IECWIN, which is provided with the R&amp;S<span style="font-family: Arial Unicode MS; font-size: 10.5pt"> </span>FSW firmware (see <a class="xref" href="a06e584a3d8b4488.htm#ID_6839b8e43365555c0a00201900794f5a-72b4cb7298c6ad230a002019000dbd4c-en-US">"The IECWIN Tool"</a>).</p><p>The tool shows an error message if a command could not be executed.</p><div class="block"><div class="listintro">Some suggestions on how you can check and improve a recorded SCPI script:</div><ul class="list"><li value="1">Search and remove missing command entries.<br/>If a configured setting or performed function does not have a corresponding command, <span class="command">:SYST:INF:SCPI 'SCPI command not available'</span> is entered in the list instead.</li><li value="2">Remove unnecessary commands written after a preset.</li><li value="3">Rearrange the commands to a reasonable order. For example, if you move a <span class="command">STATe</span> command to the end of your script, you can avoid intermediate calculations of the signal.</li><li value="4">Check the script for completeness by comparing its results with the modified settings in manual mode.</li></ul></div><div class="block"><a name="ID_72aff657d9be7fea0a001ae70846c03f-9b8758e6d84481250a001ae76d72c586-en-US">
</a><div class="procedure_title">How to export a SCPI script</div><p>When you save a command list to a file, only the recorded commands are stored in a text file. However, to execute a script in an external programming environment, it requires additional header data according to the specific format.</p><div><ol class="procedure"><li id="ID_7fb7e8f3d9be7fea0a001ae777e9f36f-9b8758e6d84481250a001ae76d72c586-en-US" value="1"><p>On the toolbar, select the SCPI Recorder icon.</p><div class="margin-in-step"><img border="0" src="Resources/Images/img5748036ed89608310a001ae7115be840_1_--_--_PNG96.png" alt="" title="" class="margin-in-step">
</img></div><p>The SCPI Recorder dialog box with the currently recorded command list is displayed.</p></li><li id="ID_b23a9693d9be7fea0a001ae75aee4de5-9b8758e6d84481250a001ae76d72c586-en-US" value="2"><p>Select "Export".</p></li><li id="ID_9a1d3436d9be7fea0a001ae71161309b-9b8758e6d84481250a001ae76d72c586-en-US" value="3"><p>Define a file name and storage location for the script file.</p></li><li id="ID_6b5fe6efd9be7fea0a001ae7355d1c7c-9b8758e6d84481250a001ae76d72c586-en-US" value="4"><p>Select the "File Type" which defines the format of the script.</p></li><li id="ID_f0985176d9be7fea0a001ae76bc8dc89-9b8758e6d84481250a001ae76d72c586-en-US" value="5"><p>Select "Save".</p><p>A script with the required header data for the selected format is stored to a file.</p></li></ol></div></div><div class="chm-go-to-top"><span><a class="chm-go-to-top" href="#top">Top</a></span></div></div></div><script type="text/javascript" src="SkinSupport/MadCapBodyEnd.js">/* <![CDATA[ */
/* ]]> */</script></body></html>